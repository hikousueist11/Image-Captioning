import streamlit as st 
#Importing libraries and models

from PIL import Image
import os
import string
import glob
from tensorflow.keras.applications import MobileNet
import tensorflow.keras.applications.mobilenet  
import tensorflow as tf
from tqdm import tqdm
import tensorflow.keras.preprocessing.image
import pickle
from tensorflow.keras.optimizers import Adam, RMSprop
from tensorflow.keras import Input, layers
from tensorflow.keras import optimizers
from pathlib import Path
from tensorflow.keras.models import Model
from io import StringIO
from tensorflow.keras.layers import add
from tensorflow.keras.preprocessing.sequence import pad_sequences
from time import time
import numpy as np
from PIL import Image
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Embedding, TimeDistributed, Dense, RepeatVector,\
                         Activation, Flatten, Reshape, concatenate, Dropout, BatchNormalization
from tensorflow.keras.applications.inception_v3 import InceptionV3
from keras.applications.inception_v3 import InceptionV3
import tensorflow.keras.applications.inception_v3
from keras.models import load_model

from tensorflow.keras.utils import to_categorical
import matplotlib.pyplot as plt
from pickle import load

wordtoindex = {'startseq': 1, 'child': 2, 'in': 3, 'pink': 4, 'dress': 5, 'is': 6, 'climbing': 7, 'up': 8, 'set': 9, 'of': 10, 'stairs': 11, 'an': 12, 'way': 13, 'endseq': 14, 'girl': 15, 'going': 16, 'into': 17, 'wooden': 18, 'building': 19, 'little': 20, 'the': 21, 'to': 22, 'her': 23, 'black': 24, 'dog': 25, 'and': 26, 'spotted': 27, 'are': 28, 'fighting': 29, 'tricolored': 30, 'playing': 31, 'with': 32, 'each': 33, 'other': 34, 'on': 35, 'road': 36, 'white': 37, 'brown': 38, 'spots': 39, 'staring': 40, 'at': 41, 'street': 42, 'two': 43, 'dogs': 44, 'different': 45, 'looking': 46, 'pavement': 47, 'moving': 48, 'toward': 49, 'covered': 50, 'paint': 51, 'sits': 52, 'front': 53, 'painted': 54, 'rainbow': 55, 'hands': 56, 'bowl': 57, 'sitting': 58, 'large': 59, 'small': 60, 'grass': 61, 'plays': 62, 'it': 63, 'there': 64, 'pigtails': 65, 'painting': 66, 'young': 67, 'outside': 68, 'man': 69, 'lays': 70, 'bench': 71, 'while': 72, 'his': 73, 'by': 74, 'him': 75, 'which': 76, 'also': 77, 'tied': 78, 'sleeping': 79, 'next': 80, 'shirtless': 81, 'lies': 82, 'park': 83, 'laying': 84, 'holding': 85, 'leash': 86, 'ground': 87, 'orange': 88, 'hat': 89, 'something': 90, 'wears': 91, 'glasses': 92, 'wearing': 93, 'beer': 94, 'can': 95, 'ears': 96, 'rope': 97, 'net': 98, 'red': 99, 'climbs': 100, 'bridge': 101, 'onto': 102, 'ropes': 103, 'playground': 104, 'running': 105, 'grassy': 106, 'garden': 107, 'surrounded': 108, 'fence': 109, 'through': 110, 'terrier': 111, 'green': 112, 'runs': 113, 'near': 114, 'shakes': 115, 'its': 116, 'head': 117, 'shore': 118, 'ball': 119, 'edge': 120, 'beach': 121, 'feet': 122, 'stands': 123, 'shaking': 124, 'off': 125, 'water': 126, 'standing': 127, 'turned': 128, 'one': 129, 'side': 130, 'boy': 131, 'smiles': 132, 'wall': 133, 'city': 134, 'overalls': 135, 'working': 136, 'stone': 137, 'walking': 138, 'paved': 139, 'metal': 140, 'pole': 141, 'behind': 142, 'smiling': 143, 'shirt': 144, 'blue': 145, 'jeans': 146, 'rock': 147, 'leaps': 148, 'over': 149, 'log': 150, 'grey': 151, 'leaping': 152, 'fallen': 153, 'tree': 154, 'collar': 155, 'jumping': 156, 'jumped': 157, 'stump': 158, 'snow': 159, 'field': 160, 'surface': 161, 'pictures': 162, 'skier': 163, 'skis': 164, 'past': 165, 'another': 166, 'person': 167, 'looks': 168, 'trees': 169, 'for': 170, 'cliff': 171, 'group': 172, 'people': 173, 'seven': 174, 'climbers': 175, 'face': 176, 'whilst': 177, 'several': 178, 'row': 179, 'watches': 180, 'holds': 181, 'line': 182, 'chases': 183, 'from': 184, 'sprinkler': 185, 'lawn': 186, 'hose': 187, 'away': 188, 'prepares': 189, 'catch': 190, 'thrown': 191, 'object': 192, 'nearby': 193, 'cars': 194, 'about': 195, 'yellow': 196, 'mouth': 197, 'toy': 198, 'ready': 199, 'flying': 200, 'air': 201, 'after': 202, 'get': 203, 'jumps': 204, 'towards': 205, 'trying': 206, 'midair': 207, 'couple': 208, 'infant': 209, 'being': 210, 'held': 211, 'male': 212, 'pond': 213, 'stroller': 214, 'sit': 215, 'baby': 216, 'their': 217, 'under': 218, 'facing': 219, 'lake': 220, 'woman': 221, 'along': 222, 'body': 223, 'outdoors': 224, 'surf': 225, 'lab': 226, 'splashes': 227, 'this': 228, 'splashing': 229, 'hole': 230, 'ice': 231, 'frozen': 232, 'men': 233, 'fishing': 234, 'play': 235, 'making': 236, 'turn': 237, 'sand': 238, 'together': 239, 'tan': 240, 'sandy': 241, 'uses': 242, 'climber': 243, 'jacket': 244, 'pants': 245, 'scaling': 246, 'waterfall': 247, 'carries': 248, 'as': 249, 'he': 250, 'walks': 251, 'carrying': 252, 'has': 253, 'item': 254, 'wet': 255, 'kayak': 256, 'life': 257, 'jackets': 258, 'rowing': 259, 'canoe': 260, 'waters': 261, 'ride': 262, 'courtyard': 263, 'catching': 264, 'chocolate': 265, 'driveway': 266, 'art': 267, 'structure': 268, 'glass': 269, 'reads': 270, 'newspaper': 271, 'sculpture': 272, 'office': 273, 'statue': 274, 'backpack': 275, 'buildings': 276, 'reading': 277, 'tent': 278, 'setting': 279, 'snowy': 280, 'very': 281, 'tall': 282, 'distance': 283, 'camera': 284, 'mountainside': 285, 'out': 286, 'view': 287, 'three': 288, 'overlooking': 289, 'valley': 290, 'hang': 291, 'top': 292, 'big': 293, 'hill': 294, 'rest': 295, 'ledge': 296, 'above': 297, 'down': 298, 'many': 299, 'inflatable': 300, 'boats': 301, 'railing': 302, 'below': 303, 'crowd': 304, 'jersey': 305, 'pose': 306, 'hand': 307, 'some': 308, 'posing': 309, 'picture': 310, 'asian': 311, 'blond': 312, 'background': 313, 'guy': 314, 'biting': 315, 'striped': 316, 'rail': 317, 'crowded': 318, 'takes': 319, 'jump': 320, 'skateboard': 321, 'performing': 322, 'trick': 323, 'leans': 324, 'skateboarder': 325, 'doing': 326, 'board': 327, 'platform': 328, 'skateboarders': 329, 'paddling': 330, 'river': 331, 'seen': 332, 'kayaking': 333, 'paddles': 334, 'boat': 335, 'paddle': 336, 'shallow': 337, 'girls': 338, 'ocean': 339, 'four': 340, 'children': 341, 'pajamas': 342, 'have': 343, 'pillow': 344, 'fight': 345, 'kids': 346, 'bed': 347, 'having': 348, 'workers': 349, 'beam': 350, 'taking': 351, 'break': 352, 'construction': 353, 'take': 354, 'seat': 355, 'train': 356, 'rides': 357, 'book': 358, 'rocky': 359, 'run': 360, 'across': 361, 'area': 362, 'end': 363, 'high': 364, 'diving': 365, 'pool': 366, 'kid': 367, 'swimming': 368, 'window': 369, 'tank': 370, 'door': 371, 'puts': 372, 'putting': 373, 'light': 374, 'hiker': 375, 'mountains': 376, 'ski': 377, 'landscape': 378, 'snowcovered': 379, 'mountain': 380, 'beautiful': 381, 'mountaintop': 382, 'attempting': 383, 'purple': 384, 'low': 385, 'cut': 386, 'yard': 387, 'frisbee': 388, 'shorts': 389, 'parking': 390, 'lot': 391, 'middle': 392, 'during': 393, 'heavy': 394, 'traffic': 395, 'mat': 396, 'between': 397, 'open': 398, 'busy': 399, 'terrain': 400, 'doberman': 401, 'chasing': 402, 'catches': 403, 'tennis': 404, 'watching': 405, 'balloons': 406, 'night': 407, 'hot': 408, 'lit': 409, 'lined': 410, 'helmet': 411, 'bike': 412, 'dirt': 413, 'bicycle': 414, 'race': 415, 'quickly': 416, 'bmx': 417, 'dark': 418, 'throwing': 419, 'bubbles': 420, 'foam': 421, 'ramp': 422, 'getting': 423, 'sticks': 424, 'tongue': 425, 'boys': 426, 'make': 427, 'faces': 428, 'sticking': 429, 'look': 430, 'silly': 431, 'blonde': 432, 'horse': 433, 'sweatshirt': 434, 'fire': 435, 'barrel': 436, 'stand': 437, 'lead': 438, 'horses': 439, 'sheep': 440, 'pushing': 441, 'skinny': 442, 'smaller': 443, 'them': 444, 'various': 445, 'safety': 446, 'harness': 447, 'indoor': 448, 'rocks': 449, 'ring': 450, 'teenage': 451, 'slide': 452, 'forest': 453, 'skiing': 454, 'wooded': 455, 'crosscountry': 456, 'skiers': 457, 'woodland': 458, 'sliding': 459, 'trail': 460, 'woods': 461, 'lone': 462, 'hikers': 463, 'pathway': 464, 'path': 465, 'happily': 466, 'dressed': 467, 'atop': 468, 'pull': 469, 'cart': 470, 'golden': 471, 'coat': 472, 'pulling': 473, 'carriage': 474, 'sled': 475, 'sheer': 476, 'using': 477, 'flat': 478, 'steep': 479, 'vest': 480, 'inside': 481, 'cave': 482, 'shows': 483, 'sunlight': 484, 'lay': 485, 'dry': 486, 'resting': 487, 'gear': 488, 'chalk': 489, 'stream': 490, 'drawing': 491, 'sidewalk': 492, 'deep': 493, 'pile': 494, 'fountain': 495, 'fountains': 496, 'sprayed': 497, 'tunnel': 498, 'course': 499, 'obstacle': 500, 'around': 501, 'swimsuit': 502, 'arms': 503, 'outstretched': 504, 'handrail': 505, 'bathing': 506, 'suit': 507, 'drinking': 508, 'spray': 509, 'soaked': 510, 'jet': 511, 'shower': 512, 'gets': 513, 'underwater': 514, 'redheaded': 515, 'swims': 516, 'alone': 517, 'snowmobile': 518, 'flies': 519, 'rider': 520, 'or': 521, 'machine': 522, 'pine': 523, 'rural': 524, 'riding': 525, 'helmets': 526, 'goggles': 527, 'drive': 528, 'heads': 529, 'atv': 530, 'wheel': 531, 'empty': 532, 'all': 533, 'vehicle': 534, 'airborne': 535, 'soccer': 536, 'arm': 537, 'tshirt': 538, 'artist': 539, 'clouds': 540, 'colors': 541, 'paper': 542, 'cyclist': 543, 'sharp': 544, 'curve': 545, 'cows': 546, 'biker': 547, 'old': 548, 'video': 549, 'lips': 550, 'gun': 551, 'collie': 552, 'audience': 553, 'watch': 554, 'onlookers': 555, 'toddler': 556, 'shoes': 557, 'attached': 558, 'that': 559, 'public': 560, 'wood': 561, 'animal': 562, 'bird': 563, 'eating': 564, 'someone': 565, 'eats': 566, 'finger': 567, 'fast': 568, 'wades': 569, 'laughs': 570, 'colorful': 571, 'outdoor': 572, 'handstand': 573, 'does': 574, 'upside': 575, 'snowboard': 576, 'surfboard': 577, 'bikes': 578, 'traveling': 579, 'motorcycles': 580, 'half': 581, 'naked': 582, 'chair': 583, 'older': 584, 'back': 585, 'relaxes': 586, 'patio': 587, 'where': 588, 'bicycles': 589, 'cap': 590, 'deck': 591, 'close': 592, 'parked': 593, 'relaxing': 594, 'topless': 595, 'floating': 596, 'both': 597, 'mouths': 598, 'tug': 599, 'chew': 600, 'haired': 601, 'drink': 602, 'hair': 603, 'party': 604, 'streets': 605, 'they': 606, 'women': 607, 'parade': 608, 'splash': 609, 'sandals': 610, 'short': 611, 'backpacks': 612, 'cardboard': 613, 'bus': 614, 'station': 615, 'room': 616, 'plants': 617, 'crossing': 618, 'sign': 619, 'beside': 620, 'family': 621, 'gathered': 622, 'van': 623, 'bright': 624, 'truck': 625, 'others': 626, 'helping': 627, 'step': 628, 'pulled': 629, 'brightly': 630, 'poses': 631, 'costume': 632, 'hugs': 633, 'who': 634, 'event': 635, 'hugging': 636, 'bicyclist': 637, 'cross': 638, 'biking': 639, 'lady': 640, 'sky': 641, 'car': 642, 'wait': 643, 'jogging': 644, 'jogs': 645, 'headphones': 646, 'plant': 647, 'store': 648, 'corner': 649, 'bicyclists': 650, 'intersection': 651, 'waiting': 652, 'bikers': 653, 'stop': 654, 'town': 655, 'without': 656, 'wagon': 657, 'leading': 658, 'hits': 659, 'hitting': 660, 'baseball': 661, 'adult': 662, 'put': 663, 'cage': 664, 'spins': 665, 'waves': 666, 'sun': 667, 'she': 668, 'marching': 669, 'band': 670, 'teenager': 671, 'game': 672, 'sneakers': 673, 'leap': 674, 'elderly': 675, 'straw': 676, 'gray': 677, 'sweater': 678, 'walk': 679, 'hallway': 680, 'colored': 681, 'flip': 682, 'flops': 683, 'hood': 684, 'legs': 685, 'boulder': 686, 'clear': 687, 'hooded': 688, 'bending': 689, 'blanket': 690, 'stuffed': 691, 'animals': 692, 'giving': 693, 'toys': 694, 'war': 695, 'floor': 696, 'nose': 697, 'silver': 698, 'closeup': 699, 'bar': 700, 'neon': 701, 'hanging': 702, 'bank': 703, 'computer': 704, 'rough': 705, 'shaped': 706, 'plastic': 707, 'team': 708, 'wear': 709, 'uniforms': 710, 'same': 711, 'hats': 712, 'caps': 713, 'flowers': 714, 'shaggy': 715, 'stick': 716, 'long': 717, 'alongside': 718, 'advertisement': 719, 'subway': 720, 'umbrella': 721, 'unicycle': 722, 'scooter': 723, 'reaches': 724, 'dock': 725, 'pier': 726, 'concrete': 727, 'landing': 728, 'table': 729, 'picnic': 730, 'luggage': 731, 'eat': 732, 'floral': 733, 'purse': 734, 'suspended': 735, 'type': 736, 'strange': 737, 'eyes': 738, 'closed': 739, 'photo': 740, 'outfit': 741, 'photograph': 742, 'just': 743, 'church': 744, 'climb': 745, 'swing': 746, 'swings': 747, 'heels': 748, 'brick': 749, 'against': 750, 'wrestle': 751, 'plain': 752, 'clothes': 753, 'asleep': 754, 'sofa': 755, 'pacifier': 756, 'bear': 757, 'soda': 758, 'vendor': 759, 'drinks': 760, 'print': 761, 'gold': 762, 'stove': 763, 'pipe': 764, 'makeup': 765, 'benches': 766, 'sunglasses': 767, 'mask': 768, 'wetsuit': 769, 'bald': 770, 'flips': 771, 'ear': 772, 'bite': 773, 'number': 774, 'six': 775, 'chased': 776, 'kneeling': 777, 'approaching': 778, 'thin': 779, 'carpet': 780, 'rug': 781, 'lying': 782, 'furry': 783, 'suits': 784, 'friends': 785, 'smile': 786, 'ladies': 787, 'bikinis': 788, 'reflection': 789, 'dances': 790, 'skirt': 791, 'crouches': 792, 'writing': 793, 'blurry': 794, 'descending': 795, 'kicking': 796, 'police': 797, 'motorcycle': 798, 'muddy': 799, 'motorbike': 800, 'uphill': 801, 'motocross': 802, 'racer': 803, 'display': 804, 'underwear': 805, 'wire': 806, 'creek': 807, 'leaning': 808, 'motion': 809, 'says': 810, 'sunset': 811, 'float': 812, 'drives': 813, 'waits': 814, 'driving': 815, 'lap': 816, 'tries': 817, 'playpen': 818, 'female': 819, 'football': 820, 'foot': 821, 'first': 822, 'seated': 823, 'candles': 824, 'birthday': 825, 'place': 826, 'cake': 827, 'trotting': 828, 'few': 829, 'adults': 830, 'splashed': 831, 'sunny': 832, 'day': 833, 'lots': 834, 'shown': 835, 'cloudy': 836, 'khaki': 837, 'passes': 838, 'sideways': 839, 'waterskier': 840, 'performs': 841, 'tricks': 842, 'waterskiing': 843, 'knee': 844, 'begins': 845, 'fall': 846, 'wakeboarding': 847, 'younger': 848, 'fish': 849, 'stare': 850, 'pitch': 851, 'uniform': 852, 'player': 853, 'backyard': 854, 'stuck': 855, 'turning': 856, 'wide': 857, 'barks': 858, 'shoulder': 859, 'fluffy': 860, 'grab': 861, 'tables': 862, 'talks': 863, 'showing': 864, 'talking': 865, 'phone': 866, 'cellphone': 867, 'flower': 868, 'attire': 869, 'device': 870, 'american': 871, 'flag': 872, 'hiking': 873, 'hikes': 874, 'underneath': 875, 'stool': 876, 'chairs': 877, 'gives': 878, 'eye': 879, 'trunks': 880, 'reflective': 881, 'swim': 882, 'block': 883, 'dirty': 884, 'bottle': 885, 'checkered': 886, 'tight': 887, 'bars': 888, 'hangs': 889, 'monkey': 890, 'jungle': 891, 'gym': 892, 'ladder': 893, 'warm': 894, 'swinging': 895, 'wings': 896, 'slides': 897, 'floaties': 898, 'hit': 899, 'jean': 900, 'railroad': 901, 'tracks': 902, 'barefoot': 903, 'bearded': 904, 'peace': 905, 'stops': 906, 'feather': 907, 'shaved': 908, 'shopping': 909, 'filled': 910, 'wave': 911, 'sports': 912, 'attempt': 913, 'five': 914, 'tire': 915, 'racers': 916, 'racing': 917, 'laughing': 918, 'bucket': 919, 'beneath': 920, 'boogie': 921, 'trampoline': 922, 'puppies': 923, 'chase': 924, 'heavily': 925, 'cold': 926, 'but': 927, 'sets': 928, 'balloon': 929, 'figure': 930, 'right': 931, 'slightly': 932, 'floats': 933, 'bikini': 934, 'huge': 935, 'scene': 936, 'skimpy': 937, 'foreground': 938, 'skating': 939, 'helps': 940, 'skate': 941, 'hold': 942, 'go': 943, 'rink': 944, 'museum': 945, 'retriever': 946, 'kissing': 947, 'cheek': 948, 'tie': 949, 'kiss': 950, 'happy': 951, 'shirts': 952, 'vests': 953, 'formal': 954, 'balcony': 955, 'amusement': 956, 'carnival': 957, 'swords': 958, 'bat': 959, 'cup': 960, 'rubber': 961, 'referee': 962, 'funny': 963, 'bushes': 964, 'matching': 965, 'denim': 966, 'gravel': 967, 'land': 968, 'puppy': 969, 'beige': 970, 'left': 971, 'frame': 972, 'help': 973, 'push': 974, 'among': 975, 'cement': 976, 'shop': 977, 'retrieves': 978, 'golf': 979, 'hind': 980, 'taken': 981, 'balls': 982, 'no': 983, 'fetch': 984, 'spectators': 985, 'pitbull': 986, 'spraying': 987, 'jack': 988, 'marker': 989, 'house': 990, 'mirror': 991, 'hoodie': 992, 'softball': 993, 'throw': 994, 'playfully': 995, 'tossing': 996, 'throws': 997, 'marked': 998, 'track': 999, 'circle': 1000, 'camping': 1001, 'equipment': 1002, 'bags': 1003, 'bottom': 1004, 'base': 1005, 'surfing': 1006, 'made': 1007, 'dune': 1008, 'snowboarding': 1009, 'poodle': 1010, 'full': 1011, 'bath': 1012, 'cloth': 1013, 'wading': 1014, 'towel': 1015, 'formation': 1016, 'walkway': 1017, 'enjoying': 1018, 'wine': 1019, 'screen': 1020, 'laptop': 1021, 'snowboarder': 1022, 'cover': 1023, 'sheet': 1024, 'females': 1025, 'clothing': 1026, 'case': 1027, 'outfits': 1028, 'dresses': 1029, 'fishes': 1030, 'tops': 1031, 'these': 1032, 'you': 1033, 'plaid': 1034, 'bag': 1035, 'speaks': 1036, 'coffee': 1037, 'restaurant': 1038, 'be': 1039, 'only': 1040, 'retrieving': 1041, 'pack': 1042, 'father': 1043, 'peak': 1044, 'like': 1045, 'cowboy': 1046, 'chain': 1047, 'neck': 1048, 'roller': 1049, 'coaster': 1050, 'shot': 1051, 'poles': 1052, 'slope': 1053, 'innertube': 1054, 'tube': 1055, 'boots': 1056, 'brunette': 1057, 'curb': 1058, 'lift': 1059, 'rolling': 1060, 'competing': 1061, 'agility': 1062, 'palm': 1063, 'touch': 1064, 'gentleman': 1065, 'lean': 1066, 'second': 1067, 'themselves': 1068, 'waist': 1069, 'pirate': 1070, 'patch': 1071, 'bandanna': 1072, 'makes': 1073, 'headscarf': 1074, 'catcher': 1075, 'points': 1076, 'pointing': 1077, 'sides': 1078, 'teams': 1079, 'players': 1080, 'volleyball': 1081, 'athletic': 1082, 'stares': 1083, 'preparing': 1084, 'forward': 1085, 'necklace': 1086, 'trunk': 1087, 'weather': 1088, 'guys': 1089, 'touches': 1090, 'brother': 1091, 'reaching': 1092, 'gloves': 1093, 'food': 1094, 'speaking': 1095, 'box': 1096, 'hurdle': 1097, 'pulls': 1098, 'cigarette': 1099, 'fisherman': 1100, 'mohawk': 1101, 'style': 1102, 'shade': 1103, 'ribbon': 1104, 'karate': 1105, 'martial': 1106, 'arts': 1107, 'practicing': 1108, 'enjoys': 1109, 'german': 1110, 'piece': 1111, 'handles': 1112, 'touching': 1113, 'graffiti': 1114, 'skateboarding': 1115, 'skater': 1116, 'amidst': 1117, 'cloud': 1118, 'kitchen': 1119, 'meal': 1120, 'spread': 1121, 'tattoos': 1122, 'backs': 1123, 'bathroom': 1124, 'mother': 1125, 'feeding': 1126, 'watched': 1127, 'raising': 1128, 'almost': 1129, 'partially': 1130, 'shoulders': 1131, 'beard': 1132, 'disc': 1133, 'try': 1134, 'attempts': 1135, 'distant': 1136, 'scales': 1137, 'fun': 1138, 'multicolored': 1139, 'branch': 1140, 'chewing': 1141, 'leafy': 1142, 'teeth': 1143, 'bleachers': 1144, 'third': 1145, 'teen': 1146, 'school': 1147, 'gate': 1148, 'crashing': 1149, 'rapids': 1150, 'cyclists': 1151, 'bottles': 1152, 'branches': 1153, 'summer': 1154, 'vehicles': 1155, 'bites': 1156, 'steps': 1157, 'bouncing': 1158, 'enclosed': 1159, 'balancing': 1160, 'leg': 1161, 'see': 1162, 'gestures': 1163, 'though': 1164, 'emerges': 1165, 'kayaker': 1166, 'goes': 1167, 'rain': 1168, 'jeep': 1169, 'training': 1170, 'pale': 1171, 'downhill': 1172, 'court': 1173, 'visible': 1174, 'counter': 1175, 'murky': 1176, 'rafting': 1177, 'tires': 1178, 'leaves': 1179, 'longhaired': 1180, 'bounds': 1181, 'skateboards': 1182, 'do': 1183, 'mud': 1184, 'crosswalk': 1185, 'not': 1186, 'so': 1187, 'narrow': 1188, 'hills': 1189, 'autumn': 1190, 'bare': 1191, 'scuba': 1192, 'diver': 1193, 'coats': 1194, 'ahead': 1195, 'petting': 1196, 'farm': 1197, 'fenced': 1198, 'pen': 1199, 'goat': 1200, 'curly': 1201, 'upsidedown': 1202, 'flipping': 1203, 'gather': 1204, 'wrestling': 1205, 'horizon': 1206, 'kite': 1207, 'countryside': 1208, 'fly': 1209, 'wheelie': 1210, 'homeless': 1211, 'couch': 1212, 'scarf': 1213, 'beads': 1214, 'slip': 1215, 'barren': 1216, 'skull': 1217, 'dust': 1218, 'blowing': 1219, 'wind': 1220, 'urban': 1221, 'digging': 1222, 'brush': 1223, 'kneels': 1224, 'string': 1225, 'rests': 1226, 'pouring': 1227, 'hay': 1228, 'fur': 1229, 'listening': 1230, 'fair': 1231, 'image': 1232, 'covering': 1233, 'mound': 1234, 'raised': 1235, 'raises': 1236, 'cricket': 1237, 'singing': 1238, 'sings': 1239, 'microphone': 1240, 'guitar': 1241, 'crawls': 1242, 'knees': 1243, 'snowball': 1244, 'fabric': 1245, 'kicks': 1246, 'teammate': 1247, 'puddle': 1248, 'opposite': 1249, 'lights': 1250, 'corn': 1251, 'photographer': 1252, 'driver': 1253, 'ridden': 1254, 'professional': 1255, 'aqua': 1256, 'country': 1257, 'flags': 1258, 'boardwalk': 1259, 'link': 1260, 'silhouette': 1261, 'rows': 1262, 'students': 1263, 'sniffs': 1264, 'sniffing': 1265, 'hoop': 1266, 'motorcyclist': 1267, 'speed': 1268, 'racetrack': 1269, 'position': 1270, 'sea': 1271, 'camouflage': 1272, 'bunch': 1273, 'picking': 1274, 'surfer': 1275, 'surfs': 1276, 'foggy': 1277, 'dreadlocks': 1278, 'flowered': 1279, 'staircase': 1280, 'embrace': 1281, 'goal': 1282, 'goalie': 1283, 'uniformed': 1284, 'fake': 1285, 'races': 1286, 'balances': 1287, 'balance': 1288, 'himself': 1289, 'tricycle': 1290, 'following': 1291, 'hike': 1292, 'tag': 1293, 'stomach': 1294, 'headfirst': 1295, 'shoreline': 1296, 'cat': 1297, 'stripes': 1298, 'swimmer': 1299, 'skinned': 1300, 'neighborhood': 1301, 'larger': 1302, 'living': 1303, 'leashes': 1304, 'reach': 1305, 'costumes': 1306, 'music': 1307, 'sprinklers': 1308, 'logs': 1309, 'itself': 1310, 'single': 1311, 'time': 1312, 'spiderman': 1313, 'candy': 1314, 'polka': 1315, 'dot': 1316, 'hardhat': 1317, 'carry': 1318, 'coming': 1319, 'stadium': 1320, 'licking': 1321, 'medium': 1322, 'sized': 1323, 'lounge': 1324, 'cream': 1325, 'follows': 1326, 'owner': 1327, 'pit': 1328, 'still': 1329, 'plate': 1330, 'dead': 1331, 'winter': 1332, 'muzzle': 1333, 'blow': 1334, 'hoops': 1335, 'arcade': 1336, 'home': 1337, 'wrapped': 1338, 'work': 1339, 'caught': 1340, 'spinning': 1341, 'turns': 1342, 'appears': 1343, 'markings': 1344, 'basketball': 1345, 'rollerblading': 1346, 'inline': 1347, 'rollerblades': 1348, 'skates': 1349, 'enjoy': 1350, 'basket': 1351, 'desert': 1352, 'space': 1353, 'porch': 1354, 'hillside': 1355, 'foliage': 1356, 'indoors': 1357, 'teenagers': 1358, 'talk': 1359, 'moves': 1360, 'stage': 1361, 'onstage': 1362, 'perform': 1363, 'snowsuit': 1364, 'licks': 1365, 'poodles': 1366, 'raft': 1367, 'parachute': 1368, 'gathering': 1369, 'duck': 1370, 'collars': 1371, 'cape': 1372, 'greyhound': 1373, 'greyhounds': 1374, 'dusk': 1375, 'surrounding': 1376, 'decorated': 1377, 'riders': 1378, 'hug': 1379, 'christmas': 1380, 'headband': 1381, 'friend': 1382, 'starting': 1383, 'money': 1384, 'market': 1385, 'grocery': 1386, 'direction': 1387, 'range': 1388, 'casting': 1389, 'chest': 1390, 'protective': 1391, 'identical': 1392, 'breaking': 1393, 'icy': 1394, 'muzzled': 1395, 'buckets': 1396, 'huddle': 1397, 'falling': 1398, 'tail': 1399, 'rear': 1400, 'broken': 1401, 'army': 1402, 'knit': 1403, 'shepherd': 1404, 'cow': 1405, 'bull': 1406, 'ponytail': 1407, 'what': 1408, 'rolls': 1409, 'paws': 1410, 'snowcapped': 1411, 'crouching': 1412, 'giant': 1413, 'before': 1414, 'toilet': 1415, 'action': 1416, 'pitcher': 1417, 'pigeons': 1418, 'birds': 1419, 'barrier': 1420, 'laugh': 1421, 'wheels': 1422, 'mostly': 1423, 'swimmers': 1424, 'swimsuits': 1425, 'smoking': 1426, 'crossed': 1427, 'herself': 1428, 'dives': 1429, 'santa': 1430, 'african': 1431, 'desk': 1432, 'parka': 1433, 'rowboat': 1434, 'roof': 1435, 'worker': 1436, 'cheerleaders': 1437, 'waving': 1438, 'stunt': 1439, 'move': 1440, 'flock': 1441, 'pair': 1442, 'grinding': 1443, 'booth': 1444, 'barn': 1445, 'signs': 1446, 'backwards': 1447, 'photographed': 1448, 'pass': 1449, 'business': 1450, 'guard': 1451, 'officer': 1452, 'bow': 1453, 'target': 1454, 'leads': 1455, 'hurdles': 1456, 'dancing': 1457, 'fancy': 1458, 'violin': 1459, 'doorway': 1460, 'eastern': 1461, 'tiger': 1462, 'tattoo': 1463, 'indian': 1464, 'native': 1465, 'hockey': 1466, 'surfers': 1467, 'airplane': 1468, 'cones': 1469, 'cone': 1470, 'flames': 1471, 'fingers': 1472, 'leaving': 1473, 'muzzles': 1474, 'sledding': 1475, 'shoveling': 1476, 'shovel': 1477, 'japanese': 1478, 'class': 1479, 'passing': 1480, 'instrument': 1481, 'mug': 1482, 'smokes': 1483, 'square': 1484, 'dance': 1485, 'meadow': 1486, 'members': 1487, 'umbrellas': 1488, 'boxing': 1489, 'sleeps': 1490, 'kisses': 1491, 'leather': 1492, 'cats': 1493, 'blows': 1494, 'barking': 1495, 'speeds': 1496, 'wedding': 1497, 'bride': 1498, 'comes': 1499, 'grabbing': 1500, 'dribbles': 1501, 'robe': 1502, 'hard': 1503, 'horseback': 1504, 'colourful': 1505, 'fetching': 1506, 'crosses': 1507, 'drums': 1508, 'instruments': 1509, 'drum': 1510, 'bounce': 1511, 'shadow': 1512, 'kick': 1513, 'straight': 1514, 'glove': 1515, 'batman': 1516, 'fireplace': 1517, 'wrestler': 1518, 'bush': 1519, 'natural': 1520, 'digs': 1521, 'part': 1522, 'alley': 1523, 'played': 1524, 'rollerskating': 1525, 'been': 1526, 'railings': 1527, 'musicians': 1528, 'pet': 1529, 'flute': 1530, 'falls': 1531, 'point': 1532, 'robes': 1533, 'pushes': 1534, 'competition': 1535, 'numbered': 1536, 'thumbs': 1537, 'racquet': 1538, 'racket': 1539, 'ducks': 1540, 'geese': 1541, 'either': 1542, 'ship': 1543, 'skyline': 1544, 'bend': 1545, 'round': 1546, 'match': 1547, 'plaza': 1548, 'apron': 1549, 'tulips': 1550, 'oklahoma': 1551, 'sooners': 1552, 'tackle': 1553, 'coach': 1554, 'strip': 1555, 'fans': 1556, 'tackled': 1557, 'jerseys': 1558, 'tackling': 1559, 'cheerleader': 1560, 'blocks': 1561, 'opposing': 1562, 'center': 1563, 'compete': 1564, 'appear': 1565, 'runners': 1566, 'crying': 1567, 'flight': 1568, 'bathtub': 1569, 'monument': 1570, 'protest': 1571, 'hospital': 1572, 'cast': 1573, 'gallery': 1574, 'wheelchair': 1575, 'show': 1576, 'jumper': 1577, 'jockey': 1578, 'blurred': 1579, 'cafe': 1580, 'banner': 1581, 'how': 1582, 'merrygoround': 1583, 'tripod': 1584, 'photographs': 1585, 'camel': 1586, 'shooting': 1587, 'bubble': 1588, 'ribbons': 1589, 'sing': 1590, 'hula': 1591, 'advertising': 1592, 'smoke': 1593, 'trashcan': 1594, 'skirts': 1595, 'followed': 1596, 'tutu': 1597, 'boarding': 1598, 'aged': 1599, 'apple': 1600, 'beagle': 1601, 'well': 1602, 'shoot': 1603, 'shoe': 1604, 'bunny': 1605, 'tents': 1606, 'traditional': 1607, 'control': 1608, 'crouched': 1609, 'tuxedos': 1610, 'gliding': 1611, 'sail': 1612, 'chews': 1613, 'clown': 1614, 'kiddie': 1615, 'athlete': 1616, 'rollerblader': 1617, 'grinds': 1618, 'sport': 1619, 'rugby': 1620, 'policeman': 1621, 'rodeo': 1622, 'stretches': 1623, 'stair': 1624, 'ridge': 1625, 'runner': 1626, 'accordion': 1627, 'officers': 1628, 'miami': 1629, 'crane': 1630, 'houses': 1631, 'eight': 1632, 'puck': 1633, 'obama': 1634, 'bone': 1635, 'swan': 1636, 'plane': 1637, 'jockeys': 1638, 'masks': 1639, 'groom': 1640, 'mural': 1641, 'daughter': 1642, 'deer': 1643, 'scarves': 1644, 'fruit': 1645, 'military': 1646, 'elephant': 1647, 'wrestlers': 1648, 'cards': 1649, 'sumo': 1650, 'camels': 1651}

indextoword = {1: 'startseq', 2: 'child', 3: 'in', 4: 'pink', 5: 'dress', 6: 'is', 7: 'climbing', 8: 'up', 9: 'set', 10: 'of', 11: 'stairs', 12: 'an', 13: 'way', 14: 'endseq', 15: 'girl', 16: 'going', 17: 'into', 18: 'wooden', 19: 'building', 20: 'little', 21: 'the', 22: 'to', 23: 'her', 24: 'black', 25: 'dog', 26: 'and', 27: 'spotted', 28: 'are', 29: 'fighting', 30: 'tricolored', 31: 'playing', 32: 'with', 33: 'each', 34: 'other', 35: 'on', 36: 'road', 37: 'white', 38: 'brown', 39: 'spots', 40: 'staring', 41: 'at', 42: 'street', 43: 'two', 44: 'dogs', 45: 'different', 46: 'looking', 47: 'pavement', 48: 'moving', 49: 'toward', 50: 'covered', 51: 'paint', 52: 'sits', 53: 'front', 54: 'painted', 55: 'rainbow', 56: 'hands', 57: 'bowl', 58: 'sitting', 59: 'large', 60: 'small', 61: 'grass', 62: 'plays', 63: 'it', 64: 'there', 65: 'pigtails', 66: 'painting', 67: 'young', 68: 'outside', 69: 'man', 70: 'lays', 71: 'bench', 72: 'while', 73: 'his', 74: 'by', 75: 'him', 76: 'which', 77: 'also', 78: 'tied', 79: 'sleeping', 80: 'next', 81: 'shirtless', 82: 'lies', 83: 'park', 84: 'laying', 85: 'holding', 86: 'leash', 87: 'ground', 88: 'orange', 89: 'hat', 90: 'something', 91: 'wears', 92: 'glasses', 93: 'wearing', 94: 'beer', 95: 'can', 96: 'ears', 97: 'rope', 98: 'net', 99: 'red', 100: 'climbs', 101: 'bridge', 102: 'onto', 103: 'ropes', 104: 'playground', 105: 'running', 106: 'grassy', 107: 'garden', 108: 'surrounded', 109: 'fence', 110: 'through', 111: 'terrier', 112: 'green', 113: 'runs', 114: 'near', 115: 'shakes', 116: 'its', 117: 'head', 118: 'shore', 119: 'ball', 120: 'edge', 121: 'beach', 122: 'feet', 123: 'stands', 124: 'shaking', 125: 'off', 126: 'water', 127: 'standing', 128: 'turned', 129: 'one', 130: 'side', 131: 'boy', 132: 'smiles', 133: 'wall', 134: 'city', 135: 'overalls', 136: 'working', 137: 'stone', 138: 'walking', 139: 'paved', 140: 'metal', 141: 'pole', 142: 'behind', 143: 'smiling', 144: 'shirt', 145: 'blue', 146: 'jeans', 147: 'rock', 148: 'leaps', 149: 'over', 150: 'log', 151: 'grey', 152: 'leaping', 153: 'fallen', 154: 'tree', 155: 'collar', 156: 'jumping', 157: 'jumped', 158: 'stump', 159: 'snow', 160: 'field', 161: 'surface', 162: 'pictures', 163: 'skier', 164: 'skis', 165: 'past', 166: 'another', 167: 'person', 168: 'looks', 169: 'trees', 170: 'for', 171: 'cliff', 172: 'group', 173: 'people', 174: 'seven', 175: 'climbers', 176: 'face', 177: 'whilst', 178: 'several', 179: 'row', 180: 'watches', 181: 'holds', 182: 'line', 183: 'chases', 184: 'from', 185: 'sprinkler', 186: 'lawn', 187: 'hose', 188: 'away', 189: 'prepares', 190: 'catch', 191: 'thrown', 192: 'object', 193: 'nearby', 194: 'cars', 195: 'about', 196: 'yellow', 197: 'mouth', 198: 'toy', 199: 'ready', 200: 'flying', 201: 'air', 202: 'after', 203: 'get', 204: 'jumps', 205: 'towards', 206: 'trying', 207: 'midair', 208: 'couple', 209: 'infant', 210: 'being', 211: 'held', 212: 'male', 213: 'pond', 214: 'stroller', 215: 'sit', 216: 'baby', 217: 'their', 218: 'under', 219: 'facing', 220: 'lake', 221: 'woman', 222: 'along', 223: 'body', 224: 'outdoors', 225: 'surf', 226: 'lab', 227: 'splashes', 228: 'this', 229: 'splashing', 230: 'hole', 231: 'ice', 232: 'frozen', 233: 'men', 234: 'fishing', 235: 'play', 236: 'making', 237: 'turn', 238: 'sand', 239: 'together', 240: 'tan', 241: 'sandy', 242: 'uses', 243: 'climber', 244: 'jacket', 245: 'pants', 246: 'scaling', 247: 'waterfall', 248: 'carries', 249: 'as', 250: 'he', 251: 'walks', 252: 'carrying', 253: 'has', 254: 'item', 255: 'wet', 256: 'kayak', 257: 'life', 258: 'jackets', 259: 'rowing', 260: 'canoe', 261: 'waters', 262: 'ride', 263: 'courtyard', 264: 'catching', 265: 'chocolate', 266: 'driveway', 267: 'art', 268: 'structure', 269: 'glass', 270: 'reads', 271: 'newspaper', 272: 'sculpture', 273: 'office', 274: 'statue', 275: 'backpack', 276: 'buildings', 277: 'reading', 278: 'tent', 279: 'setting', 280: 'snowy', 281: 'very', 282: 'tall', 283: 'distance', 284: 'camera', 285: 'mountainside', 286: 'out', 287: 'view', 288: 'three', 289: 'overlooking', 290: 'valley', 291: 'hang', 292: 'top', 293: 'big', 294: 'hill', 295: 'rest', 296: 'ledge', 297: 'above', 298: 'down', 299: 'many', 300: 'inflatable', 301: 'boats', 302: 'railing', 303: 'below', 304: 'crowd', 305: 'jersey', 306: 'pose', 307: 'hand', 308: 'some', 309: 'posing', 310: 'picture', 311: 'asian', 312: 'blond', 313: 'background', 314: 'guy', 315: 'biting', 316: 'striped', 317: 'rail', 318: 'crowded', 319: 'takes', 320: 'jump', 321: 'skateboard', 322: 'performing', 323: 'trick', 324: 'leans', 325: 'skateboarder', 326: 'doing', 327: 'board', 328: 'platform', 329: 'skateboarders', 330: 'paddling', 331: 'river', 332: 'seen', 333: 'kayaking', 334: 'paddles', 335: 'boat', 336: 'paddle', 337: 'shallow', 338: 'girls', 339: 'ocean', 340: 'four', 341: 'children', 342: 'pajamas', 343: 'have', 344: 'pillow', 345: 'fight', 346: 'kids', 347: 'bed', 348: 'having', 349: 'workers', 350: 'beam', 351: 'taking', 352: 'break', 353: 'construction', 354: 'take', 355: 'seat', 356: 'train', 357: 'rides', 358: 'book', 359: 'rocky', 360: 'run', 361: 'across', 362: 'area', 363: 'end', 364: 'high', 365: 'diving', 366: 'pool', 367: 'kid', 368: 'swimming', 369: 'window', 370: 'tank', 371: 'door', 372: 'puts', 373: 'putting', 374: 'light', 375: 'hiker', 376: 'mountains', 377: 'ski', 378: 'landscape', 379: 'snowcovered', 380: 'mountain', 381: 'beautiful', 382: 'mountaintop', 383: 'attempting', 384: 'purple', 385: 'low', 386: 'cut', 387: 'yard', 388: 'frisbee', 389: 'shorts', 390: 'parking', 391: 'lot', 392: 'middle', 393: 'during', 394: 'heavy', 395: 'traffic', 396: 'mat', 397: 'between', 398: 'open', 399: 'busy', 400: 'terrain', 401: 'doberman', 402: 'chasing', 403: 'catches', 404: 'tennis', 405: 'watching', 406: 'balloons', 407: 'night', 408: 'hot', 409: 'lit', 410: 'lined', 411: 'helmet', 412: 'bike', 413: 'dirt', 414: 'bicycle', 415: 'race', 416: 'quickly', 417: 'bmx', 418: 'dark', 419: 'throwing', 420: 'bubbles', 421: 'foam', 422: 'ramp', 423: 'getting', 424: 'sticks', 425: 'tongue', 426: 'boys', 427: 'make', 428: 'faces', 429: 'sticking', 430: 'look', 431: 'silly', 432: 'blonde', 433: 'horse', 434: 'sweatshirt', 435: 'fire', 436: 'barrel', 437: 'stand', 438: 'lead', 439: 'horses', 440: 'sheep', 441: 'pushing', 442: 'skinny', 443: 'smaller', 444: 'them', 445: 'various', 446: 'safety', 447: 'harness', 448: 'indoor', 449: 'rocks', 450: 'ring', 451: 'teenage', 452: 'slide', 453: 'forest', 454: 'skiing', 455: 'wooded', 456: 'crosscountry', 457: 'skiers', 458: 'woodland', 459: 'sliding', 460: 'trail', 461: 'woods', 462: 'lone', 463: 'hikers', 464: 'pathway', 465: 'path', 466: 'happily', 467: 'dressed', 468: 'atop', 469: 'pull', 470: 'cart', 471: 'golden', 472: 'coat', 473: 'pulling', 474: 'carriage', 475: 'sled', 476: 'sheer', 477: 'using', 478: 'flat', 479: 'steep', 480: 'vest', 481: 'inside', 482: 'cave', 483: 'shows', 484: 'sunlight', 485: 'lay', 486: 'dry', 487: 'resting', 488: 'gear', 489: 'chalk', 490: 'stream', 491: 'drawing', 492: 'sidewalk', 493: 'deep', 494: 'pile', 495: 'fountain', 496: 'fountains', 497: 'sprayed', 498: 'tunnel', 499: 'course', 500: 'obstacle', 501: 'around', 502: 'swimsuit', 503: 'arms', 504: 'outstretched', 505: 'handrail', 506: 'bathing', 507: 'suit', 508: 'drinking', 509: 'spray', 510: 'soaked', 511: 'jet', 512: 'shower', 513: 'gets', 514: 'underwater', 515: 'redheaded', 516: 'swims', 517: 'alone', 518: 'snowmobile', 519: 'flies', 520: 'rider', 521: 'or', 522: 'machine', 523: 'pine', 524: 'rural', 525: 'riding', 526: 'helmets', 527: 'goggles', 528: 'drive', 529: 'heads', 530: 'atv', 531: 'wheel', 532: 'empty', 533: 'all', 534: 'vehicle', 535: 'airborne', 536: 'soccer', 537: 'arm', 538: 'tshirt', 539: 'artist', 540: 'clouds', 541: 'colors', 542: 'paper', 543: 'cyclist', 544: 'sharp', 545: 'curve', 546: 'cows', 547: 'biker', 548: 'old', 549: 'video', 550: 'lips', 551: 'gun', 552: 'collie', 553: 'audience', 554: 'watch', 555: 'onlookers', 556: 'toddler', 557: 'shoes', 558: 'attached', 559: 'that', 560: 'public', 561: 'wood', 562: 'animal', 563: 'bird', 564: 'eating', 565: 'someone', 566: 'eats', 567: 'finger', 568: 'fast', 569: 'wades', 570: 'laughs', 571: 'colorful', 572: 'outdoor', 573: 'handstand', 574: 'does', 575: 'upside', 576: 'snowboard', 577: 'surfboard', 578: 'bikes', 579: 'traveling', 580: 'motorcycles', 581: 'half', 582: 'naked', 583: 'chair', 584: 'older', 585: 'back', 586: 'relaxes', 587: 'patio', 588: 'where', 589: 'bicycles', 590: 'cap', 591: 'deck', 592: 'close', 593: 'parked', 594: 'relaxing', 595: 'topless', 596: 'floating', 597: 'both', 598: 'mouths', 599: 'tug', 600: 'chew', 601: 'haired', 602: 'drink', 603: 'hair', 604: 'party', 605: 'streets', 606: 'they', 607: 'women', 608: 'parade', 609: 'splash', 610: 'sandals', 611: 'short', 612: 'backpacks', 613: 'cardboard', 614: 'bus', 615: 'station', 616: 'room', 617: 'plants', 618: 'crossing', 619: 'sign', 620: 'beside', 621: 'family', 622: 'gathered', 623: 'van', 624: 'bright', 625: 'truck', 626: 'others', 627: 'helping', 628: 'step', 629: 'pulled', 630: 'brightly', 631: 'poses', 632: 'costume', 633: 'hugs', 634: 'who', 635: 'event', 636: 'hugging', 637: 'bicyclist', 638: 'cross', 639: 'biking', 640: 'lady', 641: 'sky', 642: 'car', 643: 'wait', 644: 'jogging', 645: 'jogs', 646: 'headphones', 647: 'plant', 648: 'store', 649: 'corner', 650: 'bicyclists', 651: 'intersection', 652: 'waiting', 653: 'bikers', 654: 'stop', 655: 'town', 656: 'without', 657: 'wagon', 658: 'leading', 659: 'hits', 660: 'hitting', 661: 'baseball', 662: 'adult', 663: 'put', 664: 'cage', 665: 'spins', 666: 'waves', 667: 'sun', 668: 'she', 669: 'marching', 670: 'band', 671: 'teenager', 672: 'game', 673: 'sneakers', 674: 'leap', 675: 'elderly', 676: 'straw', 677: 'gray', 678: 'sweater', 679: 'walk', 680: 'hallway', 681: 'colored', 682: 'flip', 683: 'flops', 684: 'hood', 685: 'legs', 686: 'boulder', 687: 'clear', 688: 'hooded', 689: 'bending', 690: 'blanket', 691: 'stuffed', 692: 'animals', 693: 'giving', 694: 'toys', 695: 'war', 696: 'floor', 697: 'nose', 698: 'silver', 699: 'closeup', 700: 'bar', 701: 'neon', 702: 'hanging', 703: 'bank', 704: 'computer', 705: 'rough', 706: 'shaped', 707: 'plastic', 708: 'team', 709: 'wear', 710: 'uniforms', 711: 'same', 712: 'hats', 713: 'caps', 714: 'flowers', 715: 'shaggy', 716: 'stick', 717: 'long', 718: 'alongside', 719: 'advertisement', 720: 'subway', 721: 'umbrella', 722: 'unicycle', 723: 'scooter', 724: 'reaches', 725: 'dock', 726: 'pier', 727: 'concrete', 728: 'landing', 729: 'table', 730: 'picnic', 731: 'luggage', 732: 'eat', 733: 'floral', 734: 'purse', 735: 'suspended', 736: 'type', 737: 'strange', 738: 'eyes', 739: 'closed', 740: 'photo', 741: 'outfit', 742: 'photograph', 743: 'just', 744: 'church', 745: 'climb', 746: 'swing', 747: 'swings', 748: 'heels', 749: 'brick', 750: 'against', 751: 'wrestle', 752: 'plain', 753: 'clothes', 754: 'asleep', 755: 'sofa', 756: 'pacifier', 757: 'bear', 758: 'soda', 759: 'vendor', 760: 'drinks', 761: 'print', 762: 'gold', 763: 'stove', 764: 'pipe', 765: 'makeup', 766: 'benches', 767: 'sunglasses', 768: 'mask', 769: 'wetsuit', 770: 'bald', 771: 'flips', 772: 'ear', 773: 'bite', 774: 'number', 775: 'six', 776: 'chased', 777: 'kneeling', 778: 'approaching', 779: 'thin', 780: 'carpet', 781: 'rug', 782: 'lying', 783: 'furry', 784: 'suits', 785: 'friends', 786: 'smile', 787: 'ladies', 788: 'bikinis', 789: 'reflection', 790: 'dances', 791: 'skirt', 792: 'crouches', 793: 'writing', 794: 'blurry', 795: 'descending', 796: 'kicking', 797: 'police', 798: 'motorcycle', 799: 'muddy', 800: 'motorbike', 801: 'uphill', 802: 'motocross', 803: 'racer', 804: 'display', 805: 'underwear', 806: 'wire', 807: 'creek', 808: 'leaning', 809: 'motion', 810: 'says', 811: 'sunset', 812: 'float', 813: 'drives', 814: 'waits', 815: 'driving', 816: 'lap', 817: 'tries', 818: 'playpen', 819: 'female', 820: 'football', 821: 'foot', 822: 'first', 823: 'seated', 824: 'candles', 825: 'birthday', 826: 'place', 827: 'cake', 828: 'trotting', 829: 'few', 830: 'adults', 831: 'splashed', 832: 'sunny', 833: 'day', 834: 'lots', 835: 'shown', 836: 'cloudy', 837: 'khaki', 838: 'passes', 839: 'sideways', 840: 'waterskier', 841: 'performs', 842: 'tricks', 843: 'waterskiing', 844: 'knee', 845: 'begins', 846: 'fall', 847: 'wakeboarding', 848: 'younger', 849: 'fish', 850: 'stare', 851: 'pitch', 852: 'uniform', 853: 'player', 854: 'backyard', 855: 'stuck', 856: 'turning', 857: 'wide', 858: 'barks', 859: 'shoulder', 860: 'fluffy', 861: 'grab', 862: 'tables', 863: 'talks', 864: 'showing', 865: 'talking', 866: 'phone', 867: 'cellphone', 868: 'flower', 869: 'attire', 870: 'device', 871: 'american', 872: 'flag', 873: 'hiking', 874: 'hikes', 875: 'underneath', 876: 'stool', 877: 'chairs', 878: 'gives', 879: 'eye', 880: 'trunks', 881: 'reflective', 882: 'swim', 883: 'block', 884: 'dirty', 885: 'bottle', 886: 'checkered', 887: 'tight', 888: 'bars', 889: 'hangs', 890: 'monkey', 891: 'jungle', 892: 'gym', 893: 'ladder', 894: 'warm', 895: 'swinging', 896: 'wings', 897: 'slides', 898: 'floaties', 899: 'hit', 900: 'jean', 901: 'railroad', 902: 'tracks', 903: 'barefoot', 904: 'bearded', 905: 'peace', 906: 'stops', 907: 'feather', 908: 'shaved', 909: 'shopping', 910: 'filled', 911: 'wave', 912: 'sports', 913: 'attempt', 914: 'five', 915: 'tire', 916: 'racers', 917: 'racing', 918: 'laughing', 919: 'bucket', 920: 'beneath', 921: 'boogie', 922: 'trampoline', 923: 'puppies', 924: 'chase', 925: 'heavily', 926: 'cold', 927: 'but', 928: 'sets', 929: 'balloon', 930: 'figure', 931: 'right', 932: 'slightly', 933: 'floats', 934: 'bikini', 935: 'huge', 936: 'scene', 937: 'skimpy', 938: 'foreground', 939: 'skating', 940: 'helps', 941: 'skate', 942: 'hold', 943: 'go', 944: 'rink', 945: 'museum', 946: 'retriever', 947: 'kissing', 948: 'cheek', 949: 'tie', 950: 'kiss', 951: 'happy', 952: 'shirts', 953: 'vests', 954: 'formal', 955: 'balcony', 956: 'amusement', 957: 'carnival', 958: 'swords', 959: 'bat', 960: 'cup', 961: 'rubber', 962: 'referee', 963: 'funny', 964: 'bushes', 965: 'matching', 966: 'denim', 967: 'gravel', 968: 'land', 969: 'puppy', 970: 'beige', 971: 'left', 972: 'frame', 973: 'help', 974: 'push', 975: 'among', 976: 'cement', 977: 'shop', 978: 'retrieves', 979: 'golf', 980: 'hind', 981: 'taken', 982: 'balls', 983: 'no', 984: 'fetch', 985: 'spectators', 986: 'pitbull', 987: 'spraying', 988: 'jack', 989: 'marker', 990: 'house', 991: 'mirror', 992: 'hoodie', 993: 'softball', 994: 'throw', 995: 'playfully', 996: 'tossing', 997: 'throws', 998: 'marked', 999: 'track', 1000: 'circle', 1001: 'camping', 1002: 'equipment', 1003: 'bags', 1004: 'bottom', 1005: 'base', 1006: 'surfing', 1007: 'made', 1008: 'dune', 1009: 'snowboarding', 1010: 'poodle', 1011: 'full', 1012: 'bath', 1013: 'cloth', 1014: 'wading', 1015: 'towel', 1016: 'formation', 1017: 'walkway', 1018: 'enjoying', 1019: 'wine', 1020: 'screen', 1021: 'laptop', 1022: 'snowboarder', 1023: 'cover', 1024: 'sheet', 1025: 'females', 1026: 'clothing', 1027: 'case', 1028: 'outfits', 1029: 'dresses', 1030: 'fishes', 1031: 'tops', 1032: 'these', 1033: 'you', 1034: 'plaid', 1035: 'bag', 1036: 'speaks', 1037: 'coffee', 1038: 'restaurant', 1039: 'be', 1040: 'only', 1041: 'retrieving', 1042: 'pack', 1043: 'father', 1044: 'peak', 1045: 'like', 1046: 'cowboy', 1047: 'chain', 1048: 'neck', 1049: 'roller', 1050: 'coaster', 1051: 'shot', 1052: 'poles', 1053: 'slope', 1054: 'innertube', 1055: 'tube', 1056: 'boots', 1057: 'brunette', 1058: 'curb', 1059: 'lift', 1060: 'rolling', 1061: 'competing', 1062: 'agility', 1063: 'palm', 1064: 'touch', 1065: 'gentleman', 1066: 'lean', 1067: 'second', 1068: 'themselves', 1069: 'waist', 1070: 'pirate', 1071: 'patch', 1072: 'bandanna', 1073: 'makes', 1074: 'headscarf', 1075: 'catcher', 1076: 'points', 1077: 'pointing', 1078: 'sides', 1079: 'teams', 1080: 'players', 1081: 'volleyball', 1082: 'athletic', 1083: 'stares', 1084: 'preparing', 1085: 'forward', 1086: 'necklace', 1087: 'trunk', 1088: 'weather', 1089: 'guys', 1090: 'touches', 1091: 'brother', 1092: 'reaching', 1093: 'gloves', 1094: 'food', 1095: 'speaking', 1096: 'box', 1097: 'hurdle', 1098: 'pulls', 1099: 'cigarette', 1100: 'fisherman', 1101: 'mohawk', 1102: 'style', 1103: 'shade', 1104: 'ribbon', 1105: 'karate', 1106: 'martial', 1107: 'arts', 1108: 'practicing', 1109: 'enjoys', 1110: 'german', 1111: 'piece', 1112: 'handles', 1113: 'touching', 1114: 'graffiti', 1115: 'skateboarding', 1116: 'skater', 1117: 'amidst', 1118: 'cloud', 1119: 'kitchen', 1120: 'meal', 1121: 'spread', 1122: 'tattoos', 1123: 'backs', 1124: 'bathroom', 1125: 'mother', 1126: 'feeding', 1127: 'watched', 1128: 'raising', 1129: 'almost', 1130: 'partially', 1131: 'shoulders', 1132: 'beard', 1133: 'disc', 1134: 'try', 1135: 'attempts', 1136: 'distant', 1137: 'scales', 1138: 'fun', 1139: 'multicolored', 1140: 'branch', 1141: 'chewing', 1142: 'leafy', 1143: 'teeth', 1144: 'bleachers', 1145: 'third', 1146: 'teen', 1147: 'school', 1148: 'gate', 1149: 'crashing', 1150: 'rapids', 1151: 'cyclists', 1152: 'bottles', 1153: 'branches', 1154: 'summer', 1155: 'vehicles', 1156: 'bites', 1157: 'steps', 1158: 'bouncing', 1159: 'enclosed', 1160: 'balancing', 1161: 'leg', 1162: 'see', 1163: 'gestures', 1164: 'though', 1165: 'emerges', 1166: 'kayaker', 1167: 'goes', 1168: 'rain', 1169: 'jeep', 1170: 'training', 1171: 'pale', 1172: 'downhill', 1173: 'court', 1174: 'visible', 1175: 'counter', 1176: 'murky', 1177: 'rafting', 1178: 'tires', 1179: 'leaves', 1180: 'longhaired', 1181: 'bounds', 1182: 'skateboards', 1183: 'do', 1184: 'mud', 1185: 'crosswalk', 1186: 'not', 1187: 'so', 1188: 'narrow', 1189: 'hills', 1190: 'autumn', 1191: 'bare', 1192: 'scuba', 1193: 'diver', 1194: 'coats', 1195: 'ahead', 1196: 'petting', 1197: 'farm', 1198: 'fenced', 1199: 'pen', 1200: 'goat', 1201: 'curly', 1202: 'upsidedown', 1203: 'flipping', 1204: 'gather', 1205: 'wrestling', 1206: 'horizon', 1207: 'kite', 1208: 'countryside', 1209: 'fly', 1210: 'wheelie', 1211: 'homeless', 1212: 'couch', 1213: 'scarf', 1214: 'beads', 1215: 'slip', 1216: 'barren', 1217: 'skull', 1218: 'dust', 1219: 'blowing', 1220: 'wind', 1221: 'urban', 1222: 'digging', 1223: 'brush', 1224: 'kneels', 1225: 'string', 1226: 'rests', 1227: 'pouring', 1228: 'hay', 1229: 'fur', 1230: 'listening', 1231: 'fair', 1232: 'image', 1233: 'covering', 1234: 'mound', 1235: 'raised', 1236: 'raises', 1237: 'cricket', 1238: 'singing', 1239: 'sings', 1240: 'microphone', 1241: 'guitar', 1242: 'crawls', 1243: 'knees', 1244: 'snowball', 1245: 'fabric', 1246: 'kicks', 1247: 'teammate', 1248: 'puddle', 1249: 'opposite', 1250: 'lights', 1251: 'corn', 1252: 'photographer', 1253: 'driver', 1254: 'ridden', 1255: 'professional', 1256: 'aqua', 1257: 'country', 1258: 'flags', 1259: 'boardwalk', 1260: 'link', 1261: 'silhouette', 1262: 'rows', 1263: 'students', 1264: 'sniffs', 1265: 'sniffing', 1266: 'hoop', 1267: 'motorcyclist', 1268: 'speed', 1269: 'racetrack', 1270: 'position', 1271: 'sea', 1272: 'camouflage', 1273: 'bunch', 1274: 'picking', 1275: 'surfer', 1276: 'surfs', 1277: 'foggy', 1278: 'dreadlocks', 1279: 'flowered', 1280: 'staircase', 1281: 'embrace', 1282: 'goal', 1283: 'goalie', 1284: 'uniformed', 1285: 'fake', 1286: 'races', 1287: 'balances', 1288: 'balance', 1289: 'himself', 1290: 'tricycle', 1291: 'following', 1292: 'hike', 1293: 'tag', 1294: 'stomach', 1295: 'headfirst', 1296: 'shoreline', 1297: 'cat', 1298: 'stripes', 1299: 'swimmer', 1300: 'skinned', 1301: 'neighborhood', 1302: 'larger', 1303: 'living', 1304: 'leashes', 1305: 'reach', 1306: 'costumes', 1307: 'music', 1308: 'sprinklers', 1309: 'logs', 1310: 'itself', 1311: 'single', 1312: 'time', 1313: 'spiderman', 1314: 'candy', 1315: 'polka', 1316: 'dot', 1317: 'hardhat', 1318: 'carry', 1319: 'coming', 1320: 'stadium', 1321: 'licking', 1322: 'medium', 1323: 'sized', 1324: 'lounge', 1325: 'cream', 1326: 'follows', 1327: 'owner', 1328: 'pit', 1329: 'still', 1330: 'plate', 1331: 'dead', 1332: 'winter', 1333: 'muzzle', 1334: 'blow', 1335: 'hoops', 1336: 'arcade', 1337: 'home', 1338: 'wrapped', 1339: 'work', 1340: 'caught', 1341: 'spinning', 1342: 'turns', 1343: 'appears', 1344: 'markings', 1345: 'basketball', 1346: 'rollerblading', 1347: 'inline', 1348: 'rollerblades', 1349: 'skates', 1350: 'enjoy', 1351: 'basket', 1352: 'desert', 1353: 'space', 1354: 'porch', 1355: 'hillside', 1356: 'foliage', 1357: 'indoors', 1358: 'teenagers', 1359: 'talk', 1360: 'moves', 1361: 'stage', 1362: 'onstage', 1363: 'perform', 1364: 'snowsuit', 1365: 'licks', 1366: 'poodles', 1367: 'raft', 1368: 'parachute', 1369: 'gathering', 1370: 'duck', 1371: 'collars', 1372: 'cape', 1373: 'greyhound', 1374: 'greyhounds', 1375: 'dusk', 1376: 'surrounding', 1377: 'decorated', 1378: 'riders', 1379: 'hug', 1380: 'christmas', 1381: 'headband', 1382: 'friend', 1383: 'starting', 1384: 'money', 1385: 'market', 1386: 'grocery', 1387: 'direction', 1388: 'range', 1389: 'casting', 1390: 'chest', 1391: 'protective', 1392: 'identical', 1393: 'breaking', 1394: 'icy', 1395: 'muzzled', 1396: 'buckets', 1397: 'huddle', 1398: 'falling', 1399: 'tail', 1400: 'rear', 1401: 'broken', 1402: 'army', 1403: 'knit', 1404: 'shepherd', 1405: 'cow', 1406: 'bull', 1407: 'ponytail', 1408: 'what', 1409: 'rolls', 1410: 'paws', 1411: 'snowcapped', 1412: 'crouching', 1413: 'giant', 1414: 'before', 1415: 'toilet', 1416: 'action', 1417: 'pitcher', 1418: 'pigeons', 1419: 'birds', 1420: 'barrier', 1421: 'laugh', 1422: 'wheels', 1423: 'mostly', 1424: 'swimmers', 1425: 'swimsuits', 1426: 'smoking', 1427: 'crossed', 1428: 'herself', 1429: 'dives', 1430: 'santa', 1431: 'african', 1432: 'desk', 1433: 'parka', 1434: 'rowboat', 1435: 'roof', 1436: 'worker', 1437: 'cheerleaders', 1438: 'waving', 1439: 'stunt', 1440: 'move', 1441: 'flock', 1442: 'pair', 1443: 'grinding', 1444: 'booth', 1445: 'barn', 1446: 'signs', 1447: 'backwards', 1448: 'photographed', 1449: 'pass', 1450: 'business', 1451: 'guard', 1452: 'officer', 1453: 'bow', 1454: 'target', 1455: 'leads', 1456: 'hurdles', 1457: 'dancing', 1458: 'fancy', 1459: 'violin', 1460: 'doorway', 1461: 'eastern', 1462: 'tiger', 1463: 'tattoo', 1464: 'indian', 1465: 'native', 1466: 'hockey', 1467: 'surfers', 1468: 'airplane', 1469: 'cones', 1470: 'cone', 1471: 'flames', 1472: 'fingers', 1473: 'leaving', 1474: 'muzzles', 1475: 'sledding', 1476: 'shoveling', 1477: 'shovel', 1478: 'japanese', 1479: 'class', 1480: 'passing', 1481: 'instrument', 1482: 'mug', 1483: 'smokes', 1484: 'square', 1485: 'dance', 1486: 'meadow', 1487: 'members', 1488: 'umbrellas', 1489: 'boxing', 1490: 'sleeps', 1491: 'kisses', 1492: 'leather', 1493: 'cats', 1494: 'blows', 1495: 'barking', 1496: 'speeds', 1497: 'wedding', 1498: 'bride', 1499: 'comes', 1500: 'grabbing', 1501: 'dribbles', 1502: 'robe', 1503: 'hard', 1504: 'horseback', 1505: 'colourful', 1506: 'fetching', 1507: 'crosses', 1508: 'drums', 1509: 'instruments', 1510: 'drum', 1511: 'bounce', 1512: 'shadow', 1513: 'kick', 1514: 'straight', 1515: 'glove', 1516: 'batman', 1517: 'fireplace', 1518: 'wrestler', 1519: 'bush', 1520: 'natural', 1521: 'digs', 1522: 'part', 1523: 'alley', 1524: 'played', 1525: 'rollerskating', 1526: 'been', 1527: 'railings', 1528: 'musicians', 1529: 'pet', 1530: 'flute', 1531: 'falls', 1532: 'point', 1533: 'robes', 1534: 'pushes', 1535: 'competition', 1536: 'numbered', 1537: 'thumbs', 1538: 'racquet', 1539: 'racket', 1540: 'ducks', 1541: 'geese', 1542: 'either', 1543: 'ship', 1544: 'skyline', 1545: 'bend', 1546: 'round', 1547: 'match', 1548: 'plaza', 1549: 'apron', 1550: 'tulips', 1551: 'oklahoma', 1552: 'sooners', 1553: 'tackle', 1554: 'coach', 1555: 'strip', 1556: 'fans', 1557: 'tackled', 1558: 'jerseys', 1559: 'tackling', 1560: 'cheerleader', 1561: 'blocks', 1562: 'opposing', 1563: 'center', 1564: 'compete', 1565: 'appear', 1566: 'runners', 1567: 'crying', 1568: 'flight', 1569: 'bathtub', 1570: 'monument', 1571: 'protest', 1572: 'hospital', 1573: 'cast', 1574: 'gallery', 1575: 'wheelchair', 1576: 'show', 1577: 'jumper', 1578: 'jockey', 1579: 'blurred', 1580: 'cafe', 1581: 'banner', 1582: 'how', 1583: 'merrygoround', 1584: 'tripod', 1585: 'photographs', 1586: 'camel', 1587: 'shooting', 1588: 'bubble', 1589: 'ribbons', 1590: 'sing', 1591: 'hula', 1592: 'advertising', 1593: 'smoke', 1594: 'trashcan', 1595: 'skirts', 1596: 'followed', 1597: 'tutu', 1598: 'boarding', 1599: 'aged', 1600: 'apple', 1601: 'beagle', 1602: 'well', 1603: 'shoot', 1604: 'shoe', 1605: 'bunny', 1606: 'tents', 1607: 'traditional', 1608: 'control', 1609: 'crouched', 1610: 'tuxedos', 1611: 'gliding', 1612: 'sail', 1613: 'chews', 1614: 'clown', 1615: 'kiddie', 1616: 'athlete', 1617: 'rollerblader', 1618: 'grinds', 1619: 'sport', 1620: 'rugby', 1621: 'policeman', 1622: 'rodeo', 1623: 'stretches', 1624: 'stair', 1625: 'ridge', 1626: 'runner', 1627: 'accordion', 1628: 'officers', 1629: 'miami', 1630: 'crane', 1631: 'houses', 1632: 'eight', 1633: 'puck', 1634: 'obama', 1635: 'bone', 1636: 'swan', 1637: 'plane', 1638: 'jockeys', 1639: 'masks', 1640: 'groom', 1641: 'mural', 1642: 'daughter', 1643: 'deer', 1644: 'scarves', 1645: 'fruit', 1646: 'military', 1647: 'elephant', 1648: 'wrestlers', 1649: 'cards', 1650: 'sumo', 1651: 'camels'}

max_length = 34

START = "startseq"  # to know where to start generating captions
STOP = "endseq"   # to know where to stop generating captions
INCEPTION = True


#Loading Inception V3 model for transfer learning to reduce training and specifying image and output layer dimensions.
if INCEPTION:
  encode_model = InceptionV3(weights='imagenet')
  encode_model = Model(encode_model.input, encode_model.layers[-2].output)
  WIDTH = 299
  HEIGHT = 299
  OUTPUT_DIM = 2048
  preprocess_input = tensorflow.keras.applications.inception_v3.preprocess_input
else:
  encode_model = MobileNet(weights='imagenet',include_top=False)
  WIDTH = 224
  HEIGHT = 224
  OUTPUT_DIM = 50176
  preprocess_input = tensorflow.keras.applications.mobilenet.preprocess_input
  
  
#We need to encode the images to create the training set. Later we will encode new images to present them for captioning.
def encodeImage(img):
  #Resize all images to a standard size (specified bythe image encoding network)
  img = img.resize((WIDTH, HEIGHT), Image.ANTIALIAS)
  #Convert a PIL image to a numpy array
  x = tensorflow.keras.preprocessing.image.img_to_array(img)
  #Expand to 2D array
  x = np.expand_dims(x, axis=0)
  #Perform any preprocessing needed by InceptionV3 or others
  x = preprocess_input(x)
  #Call InceptionV3 (or other) to extract the smaller feature set for the image.
  x = encode_model.predict(x) # Get the encoding vector for the image
  #Shape to correct form to be accepted by LSTM captioning network.
  x = np.reshape(x, OUTPUT_DIM)
  return x

new_model = tf.keras.models.load_model('model_4.h5')

#Function to generate Captions of less than max length for each image given
def generateCaption(photo):
    in_text = START
    for i in range(max_length):
        sequence = [wordtoindex[w] for w in in_text.split() if w in wordtoindex]
        sequence = pad_sequences([sequence], maxlen=max_length)
        yhat = new_model.predict([photo,sequence], verbose=0)
        yhat = np.argmax(yhat)
        word = indextoword[yhat]
        in_text += ' ' + word
        if word == STOP:
            break
    final = in_text.split()
    final = final[1:-1]
    final = ' '.join(final)
    return final
    
def show_predict_page():
    st.title("Image Captioning Web App")
    image_file = st.file_uploader("Choose a image")
    
    if image_file is not None:
        image = Image.open(image_file)
        st.image(image) 
        
    Generate = st.button('Generate Caption')
    
    if Generate:   
      #Saving
      with open(os.path.join("fileDir",image_file.name),"wb") as f:
            f.write((image_file).getbuffer())   
            
      image_path = os.path.join('fileDir/'+ image_file.name)
      img = tensorflow.keras.preprocessing.image.load_img(image_path, target_size=(HEIGHT, WIDTH))
      img = encodeImage(img)
      img = img.reshape((1,OUTPUT_DIM))
      st.subheader(generateCaption(img))
    
      #Remove
      if os.path.exists('fileDir/'+ image_file.name):
        os.remove('fileDir/'+ image_file.name)